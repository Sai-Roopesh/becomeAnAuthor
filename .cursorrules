# Project Rules

## Tech Stack
- **Framework**: Next.js 14+ (App Router)
- **Language**: TypeScript (Strict mode)
- **Styling**: Tailwind CSS + Shadcn/UI
- **State**: Zustand
- **Database**: Dexie.js (IndexedDB)
- **Editor**: Tiptap (Headless)

## Architecture Constraints
- **Local-First**: All data persists in Dexie.js. Do not create API routes for data storage.
- **Client-Side AI**: Use `ai` SDK directly in components or custom hooks. Proxy calls through OpenRouter.
- **Type Safety**: Define interfaces for `Project`, `Scene`, `CodexEntry` in `lib/types.ts` before writing logic.
- **Performance**: Use `useLiveQuery` for DB reads. Debounce DB writes (autosave) by 1000ms.

## Coding Style
- Use functional components.
- Use `lucide-react` for icons.
- Abstract complex logic into custom hooks (e.g., `useAutosave`, `useContextAssembly`).
- Prefer `const` over `let`.
- Use `async/await` for asynchronous operations.
